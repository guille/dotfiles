[core]
	autocrlf = input
	# https://github.com/dandavison/delta/issues/359
	# Decorations needs to be first: https://github.com/dandavison/delta/issues/549
	pager = DELTA_FEATURES=$([[ ${COLUMNS:-$(tput cols)} -gt 120 ]] && echo "+decorations side-by-side" || echo "+") delta
	excludesFile = ~/.gitignore
	abbrev = 4
	editor = nvim

[init]
	defaultBranch = master

[branch]
	sort = -committerdate

[tag]
	sort = -version:refname
	gpgSign = true

[commit]
	gpgSign = true

[gpg]
	format = ssh

[log]
	abbrevCommit = true

# Separate editor for eg interactive rebases
[sequence]
	editor = subl -w

[alias]
	st = status
	co = checkout
	di = diff
	dc = diff --cached
	blamedeep = blame -w -C -C -C
	last = show --quiet
	amend = commit --amend
	qamend = commit --amend --no-edit
	pushf = push --force-with-lease
	up = !git fetch && git rebase refs/remotes/origin/HEAD
	# amending local changes before pushing
	fixup = "!git log --oneline $(git merge-base HEAD ${@:-'@{u}'})..HEAD | fzf --preview 'git show --color=always {1}' | cut -d' ' -f1 | xargs -r git commit --fixup"
	autosquash = "!git rebase --autosquash $(git merge-base HEAD ${@:-'@{u}'})"
	# same but including pushed commits
	fixupall = "!git log --since='1 month ago' --oneline | fzf --preview 'git show --color=always {1}' | cut -d' ' -f1 | xargs -r git commit --fixup"
	# weirdly useful
	git = !git
	# Stats
	ds = diff --stat=160,120 --compact-summary
	# Rebase with the given number of latest commits.
	reb = "!r() { git rebase --autosquash HEAD~$1; }; r"
	rebi = "!r() { git rebase -i HEAD~$1; }; r"
	# fancy fzf helpers
	cs = "! fzf_git_commits"
	ga = "! fzf_git_add"
	gap = "! fzf_git_add add -p"
	i = "!git add -N . && git gap"

[status]
	submoduleSummary = true

[pull]
	rebase = true

[push]
	autoSetupRemote = true
	followTags = true

[rebase]
	autoStash = true
	autoSquash = true

[fetch]
	prune = true

[interactive]
	diffFilter = delta --color-only

[delta]
	navigate = true  # use n and N to move between diff sections
	line-numbers = true
	tabs = 4
	syntax-theme = Monokai Extended
	features = decorations

[merge]
	conflictStyle = zdiff3

[diff]
	colorMoved = default
	algorithm = histogram
	submodule = log

[rerere]
	enabled = true

[column]
	ui = auto

[help]
	autocorrect = 10

[url "git@github.com:"]
	pushInsteadOf = "https://github.com/"

# Usually: work email, maintenance repos
[include]
	path = ~/.gitconfig.local

[includeIf "gitdir:~/projects/"]
	path = ~/.gitconfig-personal

[includeIf "gitdir:~/work/"]
	path = ~/.gitconfig-work

[include]
	path = ~/.gitconfig-delta
